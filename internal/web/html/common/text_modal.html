{{define "textModal"}}
<a-modal :class="themeSwitcher.currentTheme" :closable="true" :title="txtModal.title"
         id="text-modal"
         v-model="txtModal.visible">
    <template slot="footer">
        <a-button :download="txtModal.fileName" :href="'data:application/text;charset=utf-8,' + encodeURIComponent(txtModal.content)"
                  icon="download"
                  v-if="!ObjectUtil.isEmpty(txtModal.fileName)">[[ txtModal.fileName ]]
        </a-button>
        <a-button id="copy-btn" type="primary">{{ i18n "copy" }}</a-button>
    </template>
    <a-input :autosize="{ minRows: 10, maxRows: 20}" style="overflow-y: auto;" type="textarea"
             v-model="txtModal.content"></a-input>
</a-modal>

<script>

    const txtModal = {
        title: '',
        content: '',
        fileName: '',
        qrcode: null,
        clipboard: null,
        visible: false,
        show: function (title = '', content = '', fileName = '') {
            this.title = title;
            this.content = content;
            this.fileName = fileName;
            this.visible = true;
            textModalApp.$nextTick(() => {
                if (this.clipboard === null) {
                    this.clipboard = new ClipboardJS('#copy-btn', {
                        text: () => this.content,
                    });
                    this.clipboard.on('success', () => {
                        app.$message.success('{{ i18n "copied" }}')
                        this.close();
                    });
                }
            });
        },
        close: function () {
            this.visible = false;
        },
    };

    const textModalApp = new Vue({
        delimiters: ['[[', ']]'],
        el: '#text-modal',
        data: {
            txtModal: txtModal,
        },
    });

</script>
{{end}}
